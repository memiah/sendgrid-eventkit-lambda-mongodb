sudo: required
dist: trusty

services:
  - docker

env:
  ENVIRONMENT: travis

script:
  - docker-compose up
  - npm install
  - node app.js

deploy:
  provider: lambda
  role: "arn:aws:iam::057188795804:role/lambda_basic_execution"
  region: "eu-west-2"
  function_name: "sendgrid-eventkit"
  handler_name: "handler"
  runtime: "nodejs8.10"
  timeout: 10

after_script:
  - docker-compose stop
  - docker-compose rm -f
